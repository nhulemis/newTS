{"version":3,"sources":["assets\\Scripts\\SmoothFollow.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAElF,yCAAoC;AAE9B,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA0C,gCAAY;IAAtD;QAAA,qEAiDC;QA5CG,YAAM,GAAY,IAAI,CAAC;QAGvB,YAAM,GAAY,IAAI,CAAC;QAGvB,YAAM,GAAU,EAAE,CAAC;QAEnB,yBAAmB,GAAU,CAAC,CAAC;;IAoCnC,CAAC;qBAjDoB,YAAY;IAc7B,wBAAwB;IAExB,6BAAM,GAAN;QACI,cAAY,CAAC,YAAY,GAAG,IAAI,CAAC;IACrC,CAAC;IAED,4BAAK,GAAL;IAEA,CAAC;IAED,iBAAiB;IAEjB,iCAAU,GAAV,UAAW,EAAE;QAET,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;QAE5E,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAE9B,IAAG,IAAI,CAAC,mBAAmB,IAAI,CAAC,EAChC;YACI,IAAI,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;YAClC,IAAI,gBAAc,GAAG,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAG,OAAO,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC3H,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAS,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAC,gBAAc,EAAC,CAAC,GAAC,EAAE,CAAC,CAAC,CAAA;YACvG,IAAI,CAAC,mBAAmB,IAAG,EAAE,CAAC;SACjC;QAED,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAE,CAAC;QAE3E,IAAI,cAAc,GAAI,EAAE,CAAC,IAAI,EAAE,CAAC;QAChC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,EAAG,SAAS,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAExG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,mBAAS,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,EAAC,cAAc,EAAC,EAAE,GAAC,EAAE,CAAC,CAAC,CAAA;IAG5G,CAAC;;IA9CM,yBAAY,GAAiB,IAAI,CAAC;IAGzC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDACK;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDACK;IAGvB;QADC,QAAQ;gDACU;IAXF,YAAY;QADhC,OAAO;OACa,YAAY,CAiDhC;IAAD,mBAAC;CAjDD,AAiDC,CAjDyC,EAAE,CAAC,SAAS,GAiDrD;kBAjDoB,YAAY","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport Attractor from \"./Attractor\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class SmoothCamera extends cc.Component {\r\n\r\n    static smoothCamera: SmoothCamera = null;\r\n\r\n    @property(cc.Node)\r\n    target: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    planet: cc.Node = null;\r\n\r\n    @property\r\n    offset:number = 20;\r\n\r\n    timeToReturnForward:number = 1;\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        SmoothCamera.smoothCamera = this;\r\n    }\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n    // update (dt) {}\r\n\r\n    lateUpdate(dt){\r\n\r\n        let newPos = this.target.position.add( this.target.up.mulSelf(this.offset));\r\n\r\n        this.node.setPosition(newPos);\r\n\r\n        if(this.timeToReturnForward <= 1)\r\n        {\r\n            let forward = this.target.forward;\r\n            let targetRotation = cc.Quat.rotationTo(cc.quat(), this.node.forward , forward).multiply(this.node.getRotation(cc.quat()));\r\n            this.node.setRotation(Attractor.slerp(cc.quat(), this.node.getRotation(cc.quat()),targetRotation,5*dt))\r\n            this.timeToReturnForward+= dt;\r\n        }\r\n\r\n        let gravityUp = this.target.position.sub(this.planet.position).normalize();\r\n\r\n        let targetRotation =  cc.quat();\r\n        cc.Quat.rotationTo(targetRotation, this.node.up , gravityUp).multiply(this.node.getRotation(cc.quat()));\r\n\r\n        this.node.setRotation(Attractor.slerp(cc.quat(), this.node.getRotation(cc.quat()),targetRotation,50*dt))\r\n\r\n\r\n    }\r\n}\r\n"]}